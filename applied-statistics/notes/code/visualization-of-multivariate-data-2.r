aneurysm <- read.table('aneurysm.txt', header=T, sep=',')
aneurysm
#             R1          R2          C1            C2 POSLH ROT
# 1   4.61236917  1.81893482 -0.71134947 -0.8126038117     1   1
# 2   3.06352902  0.53588206 -0.23214058  0.2195964300     1   2
# 3  -2.50730813 -1.82963610 -0.14779570  1.0275683245     2   1
# 4  -0.48317413 -1.36705216 -0.13446542  0.7809211387     2   2
# 5   8.67750542 -0.72148198 -0.87794641 -0.8643967116     1   1
# 6  -1.40053106  0.30169181  0.36947194  0.8115340276     2   1
# 7  -4.83327005 -2.45149412  0.66961431  0.3983650917     2   1
# 8   3.53227839 -0.19303378  0.38545936 -0.9127160840     1   1
# 9  -1.11398956 -0.24176688  0.33910068  0.3370752431     1   1
# 10  3.81767582  0.61110120  0.21152746  0.0352946254     1   1
# 11 -0.99197415  1.47913803 -0.35256538  0.5106292669     2   2
# 12  2.45761147  1.10978681  0.50925506 -0.3519610865     1   1
# 13  1.60402907  0.81025313  0.48442554  0.4812435769     2   1
# 14  0.17245993  6.45659597 -0.08855854 -0.7949618583     1   1
# 15 10.06582110  0.40315653  0.14925257 -0.6444798500     1   2
# 16 -0.20649939 -1.97789537  0.24777487  0.4033710981     2   1
# 17 -0.39624526 -2.64895090  0.23767542 -0.1292530144     2   2
# 18 -2.29454558 -1.12230380 -0.26834700  0.0572614606     2   1
# 19  1.89749093 -0.43464404 -0.46233201  0.4906762013     2   2
# 20 -3.93543619  0.30373095  0.58250352  0.2207769119     2   1
# 21  2.19442857 -1.69890160 -0.93281115  0.5782571944     1   1
# 22  2.11325302  1.74226491 -0.45335948  0.4238558039     2   1
# 23  1.16596411 -3.31197771 -1.34906105 -0.5020878424     1   1
# 24 -3.37262214 -0.75856533 -0.56482817  0.2505782913     1   1
# 25 -5.79482948  0.04857145  0.10001856 -0.0571355690     2   2
# 26  0.27694619 -1.21581098  0.44075523 -0.1484948189     1   1
# 27 -4.76916841 -1.36402011  0.45027210 -0.3250188936     1   1
# 28  2.51646746 -0.65854940 -0.25560833  0.0287800501     2   2
# 29  1.28443876 -1.40939177  0.63878566 -0.2593380679     1   2
# 30  2.55664936  1.19188918 -0.26838756  0.4872637502     1   1
# 31  1.23623115 -0.60517101  0.22256448  0.6311006474     2   2
# 32  0.73829762  0.61147015 -0.05363886 -0.6614512618     1   1
# 33 -3.75948527 -2.01138985  0.68213495  0.3747712029     2   2
# 34 -0.48167193 -0.39814792  0.51399010 -0.0004291089     2   2
# 35 -2.25904694 -2.38665713  0.45390358 -1.5388375243     1   1
# 36  0.57969707  1.16245728 -0.49066005  0.2161494958     2   2
# 37  6.54926775 -0.85233974 -0.65126136 -0.5432549595     1   1
# 38 -0.20946857  0.10522716 -0.85099673 -0.1746455657     2   2
# 39 10.60043329  3.42886874 -1.79542595  0.1781065049     1   2
# 40 -1.94169162  0.29873687 -0.28092767  0.2306770583     2   2
# 41  0.49793287  0.28683151  0.22468619 -0.0320178444     1   2
# 42 -4.46935315 -1.52239963  0.08821432  0.0919547753     2   1
# 43 -0.60901414 -0.68953709  0.29990342  0.1532348059     2   2
# 44 -2.45916379 -0.25229754  0.73334359  0.5115293323     1   1
# 45  7.26535100 -0.26118585 -1.44742477 -0.0306652547     1   1
# 46 -0.06722902 -0.87859319  0.32957677  0.3941140621     2   1
# 47 -7.33820273  0.16212537 -0.07375616  0.4007972706     2   2
# 48  2.75095788  1.34811394 -1.20172796  0.1842977175     1   1
# 49 -1.15593706 -0.22943344  0.22087330  0.3226180181     2   1
# 50 -5.55110713 -0.05309603  0.12620830  0.3247528537     1   1
# 51 -7.76498051  5.08222285  0.60466263 -0.6800473383     1   1
# 52 -2.94481935 -3.11891796 -0.30079753  0.2087315651     2   2
# 53  2.68934422 -0.39712580  0.28358072  0.6982456065     2   2
# 54 -0.77943675  0.31030355  0.20140456 -0.1650230688     2   2
# 55 -3.04331382 -1.41437885  0.68660096  0.3761065706     2   2
# 56 -3.24165385 -0.98385207  0.77079435 -0.1201361602     2   2
# 57 -5.51617063  2.37496568  0.85732250 -0.2795976327     1   2
# 58 -3.34314290  0.20821657  0.22220675 -0.6538244202     2   2
# 59  7.38891157  0.87070713 -0.46719630 -0.3439174239     1   2
# 60 -0.21380694 -0.01004160  0.13514484 -0.2992193274     2   1
# 61  3.58346325 -1.67302440  0.04802486 -0.7840907452     1   1
# 62 -7.84523730  3.67775280  1.17175017 -0.1388942199     1   1
# 63  8.21311731  0.87658532  0.17089723 -0.3466530444     1   1
# 64 -6.12191243  5.14007895 -0.27409998 -0.1103667265     1   1
# 65 -0.88648342 -1.61459559  0.12378871 -0.1347167381     2   1

dim(aneurysm)
# [1] 65  6


aneurysm.geometry <- aneurysm[, 1:4]
aneurysm.position <- factor(aneurysm[, 5])

head(aneurysm.geometry)
#           R1         R2         C1         C2
# 1  4.6123692  1.8189348 -0.7113495 -0.8126038
# 2  3.0635290  0.5358821 -0.2321406  0.2195964
# 3 -2.5073081 -1.8296361 -0.1477957  1.0275683
# 4 -0.4831741 -1.3670522 -0.1344654  0.7809211
# 5  8.6775054 -0.7214820 -0.8779464 -0.8643967
# 6 -1.4005311  0.3016918  0.3694719  0.8115340

color.position <- ifelse(aneurysm.position == '1', 'red', 'blue')

head(aneurysm.position)
# [1] 1 1 2 2 1 2
# Levels: 1 2

head(color.position)
# [1] "red"  "red"  "blue" "blue" "red"  "blue"


attach(aneurysm.geometry)

layout(cbind(c(1, 1), c(2, 3)), widths=c(2, 1), heights=c(1, 1))
plot(R1, R2, asp=1, col=color.position, pch=16)
hist(R1, prob=T, xlim=c(-10, 15))
hist(R2, prob=T, xlim=c(-10, 15))

layout(cbind(c(1, 1), c(2, 3)), widths=c(2, 1), heights=c(1, 1))
plot(C1, C2, asp=1, col=color.position, pch=16)
hist(C1, prob=T, xlim=c(-5, 5))
hist(C2, prob=T, xlim=c(-5, 5))

detach(aneurysm.geometry)


# some statistical indices
sapply(aneurysm.geometry, mean)
#           R1           R2           C1           C2
# 1.181730e-16 1.798174e-16 1.490403e-16 6.452879e-17

sapply(aneurysm.geometry, sd)
#        R1        R2        C1        C2
# 4.1859403 1.8563342 0.5871577 0.4940132

cov(aneurysm.geometry)
#               R1            R2            C1            C2
# R1  1.752210e+01 -9.654685e-16 -1.305303e+00 -4.165673e-01
# R2 -9.654685e-16  3.445977e+00 -5.419870e-02 -1.502647e-01
# C1 -1.305303e+00 -5.419870e-02  3.447541e-01  2.946215e-16
# C2 -4.165673e-01 -1.502647e-01  2.946215e-16  2.440490e-01

cor(aneurysm.geometry)
#               R1            R2            C1            C2
# R1  1.000000e+00 -1.242479e-16 -5.310843e-01 -2.014436e-01
# R2 -1.242479e-16  1.000000e+00 -4.972537e-02 -1.638560e-01
# C1 -5.310843e-01 -4.972537e-02  1.000000e+00  1.015713e-15
# C2 -2.014436e-01 -1.638560e-01  1.015713e-15  1.000000e+00

# Attention: rounded zeros!
round(sapply(aneurysm.geometry, mean), 1)
# R1 R2 C1 C2 
#  0  0  0  0

round(cov(aneurysm.geometry), 1)
#      R1   R2   C1   C2
# R1 17.5  0.0 -1.3 -0.4
# R2  0.0  3.4 -0.1 -0.2
# C1 -1.3 -0.1  0.3  0.0
# C2 -0.4 -0.2  0.0  0.2

round(cor(aneurysm.geometry), 1)
#      R1   R2   C1   C2
# R1  1.0  0.0 -0.5 -0.2
# R2  0.0  1.0  0.0 -0.2
# C1 -0.5  0.0  1.0  0.0
# C2 -0.2 -0.2  0.0  1.0

# Scatter plot
pairs(aneurysm.geometry, col=color.position, pch=16)

# Boxplot
par(mfrow=c(1, 1))
boxplot(aneurysm.geometry, col='gold')

# Stratified boxplots
par(mfrow=c(1, 4))
boxplot(aneurysm.geometry$R1 ~ aneurysm.position, 
        col=c('red', 'blue'), main='R1')
boxplot(aneurysm.geometry$R2 ~ aneurysm.position, 
        col=c('red', 'blue'), main='R2')
boxplot(aneurysm.geometry$C1 ~ aneurysm.position, 
        col=c('red', 'blue'), main='C1')
boxplot(aneurysm.geometry$C2 ~ aneurysm.position, 
        col=c('red', 'blue'), main='C2')

# Stratified boxplots (same scale)
par(mfrow=c(1, 4))
boxplot(aneurysm.geometry$R1 ~ aneurysm.position, 
        col=c('red', 'blue'), main='R1', 
        ylim=range(aneurysm.geometry))
boxplot(aneurysm.geometry$R2 ~ aneurysm.position, 
        col=c('red', 'blue'), main='R2', 
        ylim=range(aneurysm.geometry))
boxplot(aneurysm.geometry$C1 ~ aneurysm.position, 
        col=c('red', 'blue'), main='C1', 
        ylim=range(aneurysm.geometry))
boxplot(aneurysm.geometry$C2 ~ aneurysm.position, 
        col=c('red', 'blue'), main='C2', 
        ylim=range(aneurysm.geometry))


# Chernoff faces
source('faces.R')
faces(aneurysm.geometry)

# matplot
par(mfrow=c(1,1))
matplot(t(aneurysm.geometry), type='l')
matplot(t(aneurysm.geometry), type='l', col=color.position)